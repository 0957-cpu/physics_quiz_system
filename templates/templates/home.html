{% extends "base.html" %}
{% block content %}

  <h2>ğŸ  åº­ç‘œã„Ÿç‰©ç†ç¿’é¡Œç·´ç¿’å€ â€” é¦–é </h2>
  <p>å—¨ï¼Œ{{ name }}ï¼æ­¡è¿å›ä¾†ï½</p>

  <!-- â­ ä¸Šæ–¹çµ±è¨ˆå¡ç‰‡å€ -->
  <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 12px 0;">
    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">ç´¯ç©ç©åˆ†</div>
      <div style="font-size: 1.4em; font-weight: bold;">{{ total_points or 0 }}</div>
    </div>

    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">ç›®å‰ç­‰ç´š</div>
      <div style="font-size: 1.4em; font-weight: bold;">{{ level or "â€”" }}</div>
    </div>

    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">ç­ç´šæ’å</div>
      {% if rank and total_users %}
        <div style="font-size: 1.2em; font-weight: bold;">ç¬¬ {{ rank }} å / å…± {{ total_users }} äºº</div>
      {% else %}
        <div style="font-size: 1.2em;">â€”</div>
      {% endif %}
    </div>

    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">ç¸½ä½œç­”æ¬¡æ•¸</div>
      <div style="font-size: 1.4em; font-weight: bold;">{{ total_attempts or 0 }}</div>
    </div>

    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">æœ€é«˜åˆ†</div>
      <div style="font-size: 1.4em; font-weight: bold;">
        {% if best_score is not none %}{{ best_score }}{% else %}â€”{% endif %}
      </div>
    </div>

    <div style="flex: 1 1 150px; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
      <div style="font-size: 0.9em; color: #555;">å¹³å‡åˆ†</div>
      <div style="font-size: 1.4em; font-weight: bold;">
        {% if avg_score is not none %}{{ avg_score }}{% else %}â€”{% endif %}
      </div>
    </div>
  </div>

  <!-- ğŸ“… ä»Šæ—¥ä½œç­”ç‹€æ…‹ -->
  <div style="margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 8px;">
    <h3>ğŸ“… ä»Šæ—¥ä½œç­”ç‹€æ…‹</h3>
    <p>{{ limit_msg }}</p>

    {% if reached_limit %}
      <p style="color: red; font-weight: bold;">ä»Šå¤©å·²ç¶“ä¸èƒ½å†ä½œç­”å›‰ï¼Œæ˜å¤©å†ä¾†æŒ‘æˆ°ï¼</p>
    {% elif daily_limit and daily_limit > 0 %}
      <div style="margin-top: 6px; font-size: 0.9em; color:#555;">
        å·²ä½œç­”ï¼š{{ daily_limit - (remaining or 0) }}/{{ daily_limit }} æ¬¡
      </div>
    {% endif %}

    {% if last_time and last_score is not none %}
      <div style="margin-top: 8px; font-size: 0.9em; color:#555;">
        æœ€è¿‘ä¸€æ¬¡æ¸¬é©—ï¼š{{ last_time }}ï¼Œåˆ†æ•¸ï¼š{{ last_score }} åˆ†
      </div>
    {% endif %}
  </div>

  <!-- ğŸ“Š ä»Šæ—¥ä½œç­”ç´€éŒ„ -->
  <div style="margin: 14px 0; padding: 10px; border: 1px solid #ccc; border-radius: 8px;">
    <h3>ğŸ“Š ä»Šæ—¥ä½œç­”ç´€éŒ„</h3>
    {% if today_attempts %}
      <table border="0" cellspacing="0" cellpadding="6" style="border-collapse: collapse; width: 100%; font-size: 0.95em;">
        <thead>
          <tr style="border-bottom: 1px solid #ccc;">
            <th align="left">æ™‚é–“</th>
            <th align="left">ç¬¬å¹¾æ¬¡ä½œç­”</th>
            <th align="left">åˆ†æ•¸</th>
          </tr>
        </thead>
        <tbody>
          {% for a in today_attempts %}
            <tr style="border-bottom: 1px solid #eee;">
              <td>{{ a.time }}</td>
              <td>{{ a.attempt_no }}</td>
              <td>{{ a.score }} åˆ†</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>ä»Šå¤©å°šæœªä½œç­”ï¼Œè¶•å¿«ä¾†æŒ‘æˆ°ä¸€ä»½å§ï¼</p>
    {% endif %}
  </div>

  

{% endblock %}
